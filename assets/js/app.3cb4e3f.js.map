{"version":3,"sources":["webpack:///../node_modules/offline-plugin/runtime.js","webpack:///../node_modules/webpack/buildin/harmony-module.js","webpack:///./app.js","webpack:///./scripts/service-worker.js"],"names":["hasSW","navigator","window","location","protocol","hostname","indexOf","exports","install","options","serviceWorker","register","applyUpdate","callback","errback","update","getRegistration","then","registration","module","originalModule","webpackPolyfill","Object","create","children","defineProperty","enumerable","get","l","i","hot","accept","qs","document","querySelector","bind","qsa","querySelectorAll","Element","prototype","on","addEventListener","off","removeEventListener","$root","$loader","$update","$results","e","preventDefault","vote","getResults","fetch","BASE_URL","method","res","status","text","catch","err","classList","add","remove","showResults","innerHTML","$rlines","Array","from","rates","map","el","innerText","max","Math","apply","_toConsumableArray","str","split","rate","percent","round","join","removeAttribute","readyState","setInterval","offline_plugin_runtime__WEBPACK_IMPORTED_MODULE_0__","onUpdating","onUpdateReady","onUpdated","reload","onUpdateFailed","offlineReady","goOffline","onLine","setTimeout"],"mappings":"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","file":"js/app.3cb4e3f.js","sourcesContent":["var appCacheIframe;\n\nfunction hasSW() {\n  \n    return 'serviceWorker' in navigator && (\n      window.location.protocol === 'https:' ||\n      window.location.hostname === 'localhost' ||\n      window.location.hostname.indexOf('127.') === 0\n    );\n  \n}\n\nfunction install(options) {\n  options || (options = {});\n\n  \n    if (hasSW()) {\n      var registration = navigator.serviceWorker\n        .register(\n          \"service-worker.js\", {\n            \n            \n          }\n        );\n\n      \n\n      return;\n    }\n  \n\n  \n}\n\nfunction applyUpdate(callback, errback) {\n  \n\n  \n}\n\nfunction update() {\n  \n    if (hasSW()) {\n      navigator.serviceWorker.getRegistration().then(function(registration) {\n        if (!registration) return;\n        return registration.update();\n      });\n    }\n  \n\n  \n}\n\n\n\nexports.install = install;\nexports.applyUpdate = applyUpdate;\nexports.update = update;\n","module.exports = function(originalModule) {\n\tif (!originalModule.webpackPolyfill) {\n\t\tvar module = Object.create(originalModule);\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"exports\", {\n\t\t\tenumerable: true\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","// Enable webpack HMR for extracted reelements\nmodule.hot && module.hot.accept()\n\nimport './styles/app.scss'\n\n/** Node environment */\nconst BASE_URL = PRODUCTION ? 'https://ollejah.ru:3000' : '/api'\n\n/**\n * DOM helpers\n */\n// import '@/helpers/dom'\nwindow.qs = document.querySelector.bind(document)\nwindow.qsa = document.querySelectorAll.bind(document)\nElement.prototype.on = Element.prototype.addEventListener\nElement.prototype.off = Element.prototype.removeEventListener\n\n/**\n * Votes API\n */\nconst $root = qs('html')\nconst $loader = qs('.js-loader')\nconst $update = qs('.js-update')\nconst $results = qs('.js-results')\n\nqs('a[href=\"#vote\"]').on('click', e => {\n  e.preventDefault()\n  vote()\n})\n\nqs('a[href=\"#update\"]').on('click', e => {\n  e.preventDefault()\n  getResults()\n})\n\nconst vote = () => {\n  fetch(`${BASE_URL}/vote`, {\n    method: 'POST',\n  })\n    .then(res => res.status === 200 && res.text())\n    .then(res => getResults())\n    .catch(err => console.error('Request failed', err))\n}\n\nconst getResults = () => {\n  // Before fetch\n  $root.classList.add('is-loading')\n  $update.classList.add('is-rotate')\n  $loader.classList.remove('hidden')\n\n  fetch(`${BASE_URL}/result`, {\n    method: 'POST',\n  })\n    .then(res => res.status === 200 && res.text())\n    .then(res => showResults(res))\n    .catch(err => console.error('Request failed', err))\n}\n\nconst showResults = res => {\n  $results.innerHTML = res // prerender\n  const $rlines = Array.from(qsa('.js-results .rline'))\n\n  const rates = $rlines.map(el => el.querySelector('.ocount').innerText)\n  const max = Math.max(...rates)\n  // console.log('Prc', (Math.min(...rates) / Math.max(...rates)) * 100);\n\n  const map = $rlines.map(el => {\n    const str = el.querySelector('span').innerText.split(' / ')\n    const rate = el.querySelector('.ocount').innerText\n    const percent = Math.round((rate / max) * 100)\n\n    return `\n      <article class=\"rline\" data-rate=\"${rate}\">\n        <header>\n          <h4>${str[0]}</h4> \n          <small>${str[1]}</small>\n        </header>\n        <big>${rate}</big>\n        <span class=\"rline-bar\" style=\"width:${percent}%\"></span>\n      </article>`\n  })\n  $results.innerHTML = map.join('')\n  $results.removeAttribute('hidden')\n\n  $root.classList.remove('is-loading')\n  $update.classList.remove('is-rotate')\n  $loader.classList.add('hidden')\n}\n\n/**\n * Init, check document states\n */\nconsole.time('readyStateInteractive')\nconsole.time('readyStateComplete')\ndocument.addEventListener('readystatechange', () => {\n  console.log(document.readyState)\n  if (document.readyState === 'interactive') {\n    $root.classList.remove('is-loading')\n    getResults()\n    console.timeEnd('readyStateInteractive')\n  }\n  if (document.readyState === 'complete') {\n    const int = setInterval(() => getResults(), 1000 * 600)\n    console.timeEnd('readyStateComplete')\n  }\n})\n\n/**\n * Offline plugin (ServiceWorker, AppCache) for webpack\n * https://github.com/NekR/offline-plugin/blob/master/docs/runtime.md\n */\nimport './scripts/service-worker'","/**\n * Offline plugin (ServiceWorker, AppCache) for webpack\n * https://github.com/NekR/offline-plugin/blob/master/docs/runtime.md\n * require('offline-plugin/runtime').install();\n */\n\nimport * as runtime from 'offline-plugin/runtime'\n// runtime.install()\n\nruntime.install({\n  onUpdating: () => {\n    console.info('SW runtime Event:', 'onUpdating')\n  },\n  onUpdateReady: () => {\n    console.info('SW runtime Event:', 'onUpdateReady')\n    // Tells to new SW to take control immediately\n    runtime.applyUpdate()\n  },\n  onUpdated: () => {\n    console.info('SW runtime Event:', 'onUpdated')\n    // Reload the webpage to load into the new version\n    window.location.reload()\n  },\n  onUpdateFailed: () => {\n    console.warn('SW runtime Event:', 'onUpdateFailed')\n  },\n})\n\n// setTimeout(() => runtime.applyUpdate(), 5000)\n\n/**\n * Offline state\n */\n\n/** offlineReady banner */\nconst offlineReady = document.querySelector('.js-offline-ready')\n// offlineReady.removeAttribute('hidden')\n\nfunction goOffline() {\n  if (!navigator.onLine) {\n    offlineReady.classList.add('is-active')\n    // setTimeout(() => offlineReady.classList.remove('is-active'), 10000)\n  } else {\n    offlineReady.classList.remove('is-active')\n  }\n  console.log(navigator.onLine)\n}\n\nwindow.addEventListener('offline', goOffline)\nwindow.addEventListener('online', goOffline)\n\n// Check if device online\n!navigator.onLine && setTimeout(() => goOffline(), 300)\n\nofflineReady.addEventListener('click', e =>\n  offlineReady.classList.remove('is-active')\n)"],"sourceRoot":""}